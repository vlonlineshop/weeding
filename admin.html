<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login Admin Undangan</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to bottom right, #ffe3f1, #ffedf5);
      color: #b03570;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .auth-container,
    .admin-container {
      background: #fff;
      padding: 30px 25px;
      border-radius: 20px;
      max-width: 600px;
      width: 100%;
      box-shadow: 0 0 20px 5px rgba(255, 156, 201, 0.3);
      text-align: center;
      display: none;
      flex-direction: column;
    }

    .auth-container.active,
    .admin-container.active {
      display: flex;
    }

    h1 {
      font-size: 1.8rem;
      color: #ff5ca1;
      margin-bottom: 25px;
    }

    input[type="password"],
    input[type="text"],
    textarea {
      width: 100%;
      padding: 12px;
      font-size: 1rem;
      border: 2px solid #ff9cc9;
      border-radius: 10px;
      margin-bottom: 20px;
      box-sizing: border-box;
      resize: vertical;
    }

    button {
      padding: 12px 20px;
      background: #ff5ca1;
      color: white;
      font-size: 1rem;
      font-weight: bold;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.3s ease;
      margin-bottom: 10px;
      align-self: flex-start;
    }

    button:hover {
      background: #e84e93;
    }

    .loading-text {
      display: none;
      color: #777;
      font-size: 0.95rem;
      margin-top: 15px;
    }

    a.link-undangan {
      display: inline-block;
      color: #ff5ca1;
      text-decoration: none;
      word-wrap: break-word;
      margin: 5px 0;
      max-width: 100%;
      font-size: 0.95rem;
    }

    .link-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 6px;
      flex-wrap: wrap;
    }

    .copy-link-btn {
      background: #b03570;
      border: none;
      border-radius: 6px;
      color: white;
      padding: 6px 10px;
      font-size: 0.85rem;
      cursor: pointer;
      transition: background 0.3s ease;
      white-space: nowrap;
    }

    .copy-link-btn:hover {
      background: #8a2a57;
    }

    #linksContainer {
      margin-top: 15px;
      width: 100%;
      max-height: 300px;
      overflow-y: auto;
      background: #ffe3f1;
      padding: 15px;
      border-radius: 12px;
      text-align: left;
      box-sizing: border-box;
    }
  </style>
</head>
<body>

  <!-- Login Access -->
  <div class="auth-container active" id="loginBox">
    <h1>Kode Akses Admin</h1>
    <input id="accessCode" type="password" placeholder="Masukkan Kode Akses" autocomplete="off" />
    <button onclick="verifyAccess()">Masuk</button>
    <p class="loading-text" id="loadingText">Mengalihkan ke halaman admin...</p>
  </div>

  <!-- Admin Area -->
  <div class="admin-container" id="adminArea">
    <h1>Admin Undangan</h1>

    <!-- Input Nama Tamu Tunggal -->
    <input id="namaTamu" type="text" placeholder="Masukkan Nama Tamu" autocomplete="off" />
    <button onclick="generateSingleLink()">Buat Link Undangan</button>

    <a id="generatedLink" target="_blank" style="display: none; margin-bottom: 10px;"></a>
    <button onclick="copyLink()" id="copyBtn" style="display: none;">Salin Link</button>

    <hr style="width: 100%; margin: 25px 0; border: 1px solid #ff9cc9; border-radius: 5px;" />

    <!-- Input Massal -->
    <label for="namaMassal" style="align-self: flex-start; margin-bottom: 8px; font-weight: bold;">Input Nama Tamu Massal (satu nama per baris):</label>
    <textarea id="namaMassal" rows="6" placeholder="Contoh:&#10;Andi&#10;Budi&#10;Citra"></textarea>
    <button onclick="generateBulkLinks()">Buat Link Undangan Massal</button>

    <div id="linksContainer"></div>
  </div>

  <script>
    // Nonaktifkan Ctrl+U, F12, Ctrl+Shift+I, klik kanan
    document.addEventListener('keydown', function (e) {
      if (
        (e.ctrlKey && e.key.toLowerCase() === 'u') ||
        e.key === 'F12' ||
        (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === 'i')
      ) {
        e.preventDefault();
        alert("Akses developer tools diblokir.");
      }
    });

    document.addEventListener('contextmenu', function (e) {
      e.preventDefault();
      alert("Klik kanan dinonaktifkan.");
    });

    const KODE_AKSES = "PREMIUMVL";

    function verifyAccess() {
      const input = document.getElementById('accessCode').value.trim();
      const loadingText = document.getElementById('loadingText');

      if (input === KODE_AKSES) {
        loadingText.style.display = "block";
        setTimeout(() => {
          document.getElementById('loginBox').classList.remove('active');
          document.getElementById('adminArea').classList.add('active');
        }, 1500);
      } else {
        alert("Kode salah, silakan coba lagi.");
        setTimeout(() => {
          location.reload();
        }, 500);
      }
    }

    function capitalizeWords(str) {
      return str.replace(/\b\w/g, char => char.toUpperCase());
    }

    // Generate link untuk 1 nama
    function generateSingleLink() {
      let name = document.getElementById('namaTamu').value.trim();
      if (name === '') {
        alert('Silakan masukkan nama tamu terlebih dahulu.');
        return;
      }
      if (!/^[a-zA-Z\s]+$/.test(name)) {
        alert("Nama hanya boleh mengandung huruf dan spasi.");
        return;
      }
      name = capitalizeWords(name);
      const url = `${location.origin}/weeding/index.html?nama=${encodeURIComponent(name)}`;
      const link = document.getElementById('generatedLink');
      link.href = url;
      link.textContent = url;
      link.style.display = 'block';

      document.getElementById('copyBtn').style.display = 'inline-block';
    }

    function copyLink() {
      const link = document.getElementById('generatedLink').href;
      navigator.clipboard.writeText(link).then(() => {
        alert("Link disalin ke clipboard!");
      });
    }

    // Generate links massal
    function generateBulkLinks() {
      const rawText = document.getElementById('namaMassal').value.trim();
      if (rawText === '') {
        alert("Masukkan minimal satu nama tamu.");
        return;
      }
      const names = rawText.split('\n')
        .map(name => name.trim())
        .filter(name => name.length > 0);

      if (names.length === 0) {
        alert("Tidak ada nama valid ditemukan.");
        return;
      }

      // Validasi semua nama
      for (const name of names) {
        if (!/^[a-zA-Z\s]+$/.test(name)) {
          alert(`Nama "${name}" mengandung karakter tidak valid. Hanya huruf dan spasi diperbolehkan.`);
          return;
        }
      }

      const container = document.getElementById('linksContainer');
      container.innerHTML = ''; // reset

      names.forEach(name => {
        const capName = capitalizeWords(name);
        const url = `${location.origin}/weeding/index.html?nama=${encodeURIComponent(capName)}`;

        // buat elemen
        const row = document.createElement('div');
        row.classList.add('link-row');

        const link = document.createElement('a');
        link.className = 'link-undangan';
        link.href = url;
        link.target = "_blank";
        link.textContent = url;

        const btnCopy = document.createElement('button');
        btnCopy.className = 'copy-link-btn';
        btnCopy.textContent = 'Salin';
        btnCopy.addEventListener('click', () => {
          navigator.clipboard.writeText(url).then(() => {
            alert(`Link undangan untuk "${capName}" berhasil disalin!`);
          });
        });

        row.appendChild(link);
        row.appendChild(btnCopy);
        container.appendChild(row);
      });
    }
  </script>

</body>
</html>
